<!DOCTYPE html>
<html>
<head>
    <title>AngularJS Pagination</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <style type="text/css">
        .container {
            margin-top: 20px;
        }
        .pagination {
            display: inline-block;
        }
        .pagination:after {
            content: " ";
            display: table;
            clear: both;
        }
        .pagination li {
            cursor: pointer;
        }
        .pagination-wrap {
            text-align: center;
        }
        img {
            width: 230px;
            height: 230px;
        }
        li {
            list-style: none;
        }
    </style>

    <script src="angular.min.js"></script>

    <script>
        var app = angular.module( 'app', [ ] )

            .factory('pagination', function( $sce ) {

                var currentPage = 0;
                var itemsPerPage = 4;
                var companies = [];

                return {

                    setProducts: function( newProducts ) {
                        companies = newProducts
                    }, /* END of setProducts */

                    getPageProducts: function(num) {
                        var num = angular.isUndefined(num) ? 0 : num;
                        var first = itemsPerPage * num;
                        var last = first + itemsPerPage;
                        currentPage = num;
                        last = last > companies.length ? (companies.length - 1) : last;
                        return companies.slice(first, last);
                    }, /* END of getPageProducts */

                    getTotalPagesNum: function() {
                        return Math.ceil( companies.length / itemsPerPage );
                    }, /* END of getTotalPagesNum */

                    getPaginationList: function() {
                        var pagesNum = this.getTotalPagesNum();
                        var paginationList = [];
                        paginationList.push({
                            name: $sce.trustAsHtml('&laquo;'),
                            link: 'prev'
                        });
                        for (var i = 0; i < pagesNum; i++) {
                            var name = i + 1;
                            paginationList.push({
                                name: $sce.trustAsHtml( String(name) ),
                                link: i
                            });
                        };
                        paginationList.push({
                            name: $sce.trustAsHtml('&raquo;'),
                            link: 'next'
                        });
                        if (pagesNum > 2) {
                            return paginationList;
                        } else {
                            return null;
                        }
                    }, /* END of getPaginationList */

                    getPrevPageProducts: function() {
                        var prevPageNum = currentPage - 1;
                        if ( prevPageNum < 0 ) prevPageNum = 0;
                        return this.getPageProducts( prevPageNum );
                    }, /* END of getPrevPageProducts */

                    getNextPageProducts: function() {
                        var nextPageNum = currentPage + 1;
                        var pagesNum = this.getTotalPagesNum();
                        if ( nextPageNum >= pagesNum ) nextPageNum = pagesNum - 1;
                        return this.getPageProducts( nextPageNum );
                    }, /* END of getNextPageProducts */

                    getCurrentPageNum: function() {
                        return currentPage;
                    }, /* END of getCurrentPageNum */

                }
            }) /* END of factory-pagination */

            .controller('mainCtrl', function( $scope, $http, pagination ){

                $http.get('./companies.json')
                    .success(function(data){
                        $scope.menuObj = data;
                        pagination.setProducts( data.companies);
                        $scope.companies = pagination.getPageProducts( $scope.currentPage );
                        $scope.paginationList = pagination.getPaginationList();
                    });

                $scope.showPage = function(page) {
                    if ( page == 'prev' ) {
                        $scope.companies = pagination.getPrevPageProducts();
                    } else if ( page == 'next' ) {
                        $scope.companies = pagination.getNextPageProducts();
                    } else {
                        $scope.companies = pagination.getPageProducts( page );
                    }
                }

                $scope.currentPageNum = function() {
                    return pagination.getCurrentPageNum();
                }
                $scope.f = function(crunchbase_url,twitter_username,category_code,number_of_employees,phone_number,created_at,available_sizes,title) {
                    document.write(crunchbase_url+"<br>"+twitter_username+"<br>"+category_code+"<br>"+number_of_employees+"<br>"+phone_number+"<br>"+created_at+"<br>"+available_sizes+"<br>"+title);
                }

            })
    </script>
</head>

<body ng-app="app" ng-controller="mainCtrl">

<div class="container">

    <div class="row">

        <div ng-repeat="item in companies" ng-click="f(item._id.$oid,item.crunchbase_url,item.twitter_username,item.category_code,item.number_of_employees,item.phone_number,item.created_at,item.available_sizes,item.relationships.title)" class="col-sm-3">
            <div class="thumbnail">
                <div class="caption">
                    <h1>{{ item.name }}</h1>
                    {{item._id.$oid}}
                    {{item.crunchbase_url}}
                </div>
            </div>
        </div>

    </div>

    <div class="pagination-wrap">
        <ul class="pagination">
            <li ng-repeat="page in paginationList" ng-click="showPage(page.link)" ng-class="{'active': currentPageNum() == page.link}"><a ng-bind-html="page.name"></a></li>
        </ul>
    </div>

</div>


</body>
</html>