<!DOCTYPE html>
<html>
<head>
    <title>AngularJS Pagination</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <style type="text/css">
        .container {
            margin-top: 20px;
        }
        .pagination {
            display: inline-block;
        }
        .pagination:after {
            content: " ";
            display: table;
            clear: both;
        }
        .pagination li {
            cursor: pointer;
        }
        .pagination-wrap {
            text-align: center;
        }
        img {
            width: 230px;
            height: 230px;
        }
        li {
            list-style: none;
        }
    </style>

    <script src="angular.min.js"></script>
</head>
<body ng-app="app" ng-controller="mainCtrl">
<div class="container">

    <div class="row">

        <div ng-repeat="item in restaurant" ng-click="f(item.URL,item.name,item._id,item.rating,item.type_of_food,item.outcode,item.postcode)">
            <div class="thumbnail">
                <div class="caption">
                    <h1>{{item.name}}</h1>
                    {{item.URL}}
                </div>
            </div>

        </div>

        <div class="pagination-wrap">
            <ul class="pagination">
                <li ng-repeat="page in paginationList" ng-click="showPage(page.link)" ng-class="{'active': currentPageNum() == page.link}"><a ng-bind-html="page.name"></a></li>
            </ul>
        </div>

    </div>
</div>

<script>
    var app = angular.module( 'app', [ ] )

        .factory('pagination', function( $sce ) { //$sce is a service that provides Strict Contextual Escaping services to AngularJS.

            var currentPage = 0;
            var itemsPerPage = 4;
            var restourant = [];

            return {

                setProducts: function( newProducts ) {
                    restourant = newProducts
                }, /* END of setProducts */

                getPageProducts: function(num) {
                    var num = angular.isUndefined(num) ? 0 : num;//True if value is undefined.
                    var first = itemsPerPage * num;
                    var last = first + itemsPerPage;
                    currentPage = num;
                    last = last > restourant.length ? (restourant.length - 1) : last;
                    return restourant.slice(first, last);
                }, /* END of getPageProducts */

                getTotalPagesNum: function() {
                    return Math.ceil( restourant.length / itemsPerPage );
                }, /* END of getTotalPagesNum */

                getPaginationList: function() {
                    var pagesNum = this.getTotalPagesNum();
                    var paginationList = [];
                    paginationList.push({
                        name: $sce.trustAsHtml('&laquo;'),
                        link: 'prev'
                    });
                    for (var i = 0; i < pagesNum; i++) {
                        var name = i + 1;
                        paginationList.push({
                            name: $sce.trustAsHtml( String(name) ),
                            link: i
                        });
                    };
                    paginationList.push({
                        name: $sce.trustAsHtml('&raquo;'),
                        link: 'next'
                    });
                    if (pagesNum > 2) {
                        return paginationList;
                    } else {
                        return null;
                    }
                }, /* END of getPaginationList */

                getPrevPageProducts: function() {
                    var prevPageNum = currentPage - 1;
                    if ( prevPageNum < 0 ) prevPageNum = 0;
                    return this.getPageProducts( prevPageNum );
                }, /* END of getPrevPageProducts */

                getNextPageProducts: function() {
                    var nextPageNum = currentPage + 1;
                    var pagesNum = this.getTotalPagesNum();
                    if ( nextPageNum >= pagesNum ) nextPageNum = pagesNum - 1;
                    return this.getPageProducts( nextPageNum );
                }, /* END of getNextPageProducts */

                getCurrentPageNum: function() {
                    return currentPage;
                }, /* END of getCurrentPageNum */

            }
        }) /* END of factory-pagination */

        .controller('mainCtrl', function( $scope, $http, pagination ){

            $http.get('./restourant.json')
                .success(function(data){
                    $scope.menuObj = data;
                    pagination.setProducts( data.restourant );
                    $scope.restourant = pagination.getPageProducts( $scope.currentPage );
                    $scope.paginationList = pagination.getPaginationList();
                });

            $scope.showPage = function(page) {
                if ( page == 'prev' ) {
                    $scope.restourant = pagination.getPrevPageProducts();
                } else if ( page == 'next' ) {
                    $scope.restourant = pagination.getNextPageProducts();
                } else {
                    $scope.restourant = pagination.getPageProducts( page );
                }
            }

            $scope.currentPageNum = function() {
                return pagination.getCurrentPageNum();
            }
            $scope.f = function(URL,name,_id,type_of_food,outcode,postcode,rating) {
                document.write();URL+"<br>"+name+"<br>"+_id+"<br>"+type_of_food+"<br>"+outcode+"<br>"+postcode+"<br>"+rating
            }

        })
</script>
</body>
</html>





